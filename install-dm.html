<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Okera Install - Setting Up the Deployment Manager | Okera User Documentation</title>
<link rel="stylesheet" href="theme/css/syntax.css">
<link rel="icon" type="image/png" href="/assets/images/icon-favicon32.png">

<script src="https://use.fontawesome.com/d9343c4626.js"></script>

<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="theme/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
  crossorigin="anonymous">
<!-- Old Algolia Instant Search -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css"> -->
<!-- End Old Algolia Instant Search -->
<link rel="stylesheet" href="theme/css/asciidoctor.css">
<link rel="stylesheet" href="theme/css/custom.css">
<link rel="stylesheet" href="theme/css/boxshadowproperties.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="theme/js/jquery.navgoco.min.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
  crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="theme/js/toc.js"></script>
<script src="theme/js/customscripts.js"></script>

<!-- Old Algolia Instant Search -->
<!-- <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script> -->
<!-- End Old Algolia Instant Search -->

<!-- Include AlgoliaSearch JS Client and autocomplete.js library -->
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>

<script>
  $(document).ready(function () {
    $("blockquote:contains('Note')").addClass("admonitionblock note");
    $("blockquote:contains('Warning')").addClass("admonitionblock warning");
    $("blockquote:contains('Tip')").addClass("admonitionblock tip");
    $(".admonitionblock.note").prepend('<i class="fa fa-check admonition"></i>');
    $(".admonitionblock.warning").prepend('<i class="fa fa-exclamation-triangle admonition"></i>');
    $(".admonitionblock.tip").prepend('<i class="fa fa-lightbulb-o admonition"></i>');
  });
</script>


<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">

        <div class="row">
            <div class="col-sm-4 col-md-3">

                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <div class="navbar-wordmark">
                        <a href="/">
                            <img src="assets/images/okera-wordmark-white.svg" alt="Okera wordmark" />
                        </a>
                    </div>
                </div>

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

                    <ul class="nav navbar-nav">
                        <!-- toggle sidebar button -->
                        <!-- <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li> -->
                        <!-- entries without drop-downs appear here -->

                            
                        <li>
                            <a href="https://okera.com" target="_blank">okera.com</a>
                        </li>
                          
                        <!-- entries with drop-downs appear here -->
                        <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                         
                    </ul>
                </div>
            </div>
            <form class="aa-input-container navbar-form" id="aa-input-container" role="search">
                <div class="form-group">
                    <input id="aa-search-input" type="text" class="aa-input-search form-control" placeholder="Search"
                        autocomplete="off">
                </div>
            </form>
        </div>
        <!-- Algolia Integrated search Script -->
        <script type="text/javascript" src="theme/js/okera-integrated-search.js"></script>
        <!-- comment out this block if you want to hide jekyll search
                  <div class="navbar-form" id="search-demo-container">
                      <form action="/search" method="GET">
                      <input type="text" name="q" id="search-input" placeholder="Search the docs...">
                      </form>
                  </div>
                end search -->
    </div>
</nav>
<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                


<ul id="mysidebar" class="nav affix">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a href="#">Introduction to Okera</a>
      <ul>
          
          
          
          <li><a href="product-overview">Product Overview</a> </li>
          
          
          
          
          
          
          <li><a href="odas-overview">Okera Data Access Service Overview</a> </li>
          
          
          
          
          
          
          <li><a href="catalog-overview">Okera Catalog Overview</a> </li>
          
          
          
          
          
          
          <li><a href="okera-architecture-overview">Platform Architecture Overview</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Installing Okera</a>
      <ul>
          
          
          
          <li><a href="getting-started">Getting Started</a> </li>
          
          
          
          
          
          
          <li><a href="install">Installation Overview</a> </li>
          
          
          
          
          
          
          <li><a href="install-prereqs">Installation Prerequisites</a> </li>
          
          
          
          
          
          
          <li class="active"><a href="install-dm">Setting up the Deployment Manager</a></li>
          
          
          
          
          
          
          <li><a href="install-odas">Setting up the ODAS Cluster</a> </li>
          
          
          
          
          
          
          <li><a href="advanced-install">Advanced Installation Options</a> </li>
          
          
          
          
          
          
          <li><a href="awsguide">AWS Guide</a> </li>
          
          
          
          
          
          
          <li><a href="odas-authentication">Authentication Guide</a> </li>
          
          
          
          
          
          
          <li><a href="kerberos-cluster-setup">Kerberos</a> </li>
          
          
          
          
          
          
          <li><a href="secure-okera-rest-api-ldap">LDAP Authentication</a> </li>
          
          
          
          
          
          
          <li><a href="secure-okera-rest-api-oauth">OAuth Authentication</a> </li>
          
          
          
          
          
          
          <li><a href="secure-deployment-manager-rest-api">Deployment Manager REST Security</a> </li>
          
          
          
          
          
          
          <li><a href="support-versions">Versions</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Administering ODAS Clusters</a>
      <ul>
          
          
          
          <li><a href="cluster-administration">Cluster Administration</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-types">Cluster Types</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-sizing">Cluster Sizing</a> </li>
          
          
          
          
          
          
          <li><a href="memory-usage">Platform Memory Usage</a> </li>
          
          
          
          
          
          
          <li><a href="ip-address-management">IP Address Management</a> </li>
          
          
          
          
          
          
          <li><a href="kubernetes-dashboard-quickstart">Cluster Monitoring with Kubernetes Addons</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-launch-plugin-api">Cluster Launch API</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Using the Catalog</a>
      <ul>
          
          
          
          <li><a href="authorization">Role-based Access Control</a> </li>
          
          
          
          
          
          
          <li><a href="privileges">Privileges</a> </li>
          
          
          
          
          
          
          <li><a href="schema-design">Schema Design</a> </li>
          
          
          
          
          
          
          <li><a href="authorization-builtins">Authorization Builtin Functions</a> </li>
          
          
          
          
          
          
          <li><a href="auditing">Auditing</a> </li>
          
          
          
          
          
          
          <li><a href="okera-database-cli">Database CLI</a> </li>
          
          
          
          
          
          
          <li><a href="supported-sql">Supported SQL</a> </li>
          
          
          
          
          
          
          <li><a href="jdbc-data-source">JDBC Data Source</a> </li>
          
          
          
          
          
          
          <li><a href="data-types">Supported Data Types</a> </li>
          
          
          
          
          
          
          <li><a href="complex-types">Complex Data Types</a> </li>
          
          
          
          
          
          
          <li><a href="extending-odas">Extending ODAS</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Using the Web UI</a>
      <ul>
          
          
          
          <li><a href="web-ui-basics">Okera Portal Basics</a> </li>
          
          
          
          
          
          
          <li><a href="datasets-page">Datasets Page</a> </li>
          
          
          
          
          
          
          <li><a href="permissions-page">Permissions Page</a> </li>
          
          
          
          
          
          
          <li><a href="reports-page">Reports Page</a> </li>
          
          
          
          
          
          
          <li><a href="web-ui-admin">Okera Portal for Admins</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Integrating with ODAS</a>
      <ul>
          
          
          
          <li><a href="catalog-rest-api">REST API</a> </li>
          
          
          
          
          
          
          <li><a href="client-configs">Client Configuration</a> </li>
          
          
          
          
          
          
          <li><a href="hive-best-practices">Hive Integration - Best Practices</a> </li>
          
          
          
          
          
          
          <li><a href="emr-integration">EMR Integration</a> </li>
          
          
          
          
          
          
          <li><a href="pyokera">Native Python Integration</a> </li>
          
          
          
          
          
          
          <li><a href="client-integration">Client Integration</a> </li>
          
          
          
          
          
          
          <li><a href="planner-integration">Planner Integration</a> </li>
          
          
          
          
          
          
          <li><a href="third-party-integration">Third-Party Integration</a> </li>
          
          
          
          
          
          
          <li><a href="odas-cdh-integration">CDH Integration</a> </li>
          
          
          
          
          
          
          <li><a href="tableau-web-data-connector">Tableau Integration</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Reference</a>
      <ul>
          
          
          
          <li><a href="release-notes">Release Notes</a> </li>
          
          
          
          
          
          
          <li><a href="earlier-release-notes">Earlier Release Notes</a> </li>
          
          
          
          
          
          
          <li><a href="service-port-assignments">Service Ports</a> </li>
          
          
          
          
          
          
          <li><a href="s3-encryption-support">Supported S3 Encryption Types</a> </li>
          
          
          
          
          
          
          <li><a href="compatibility-guarantees">Compatibility Guarantees</a> </li>
          
          
          
          
          
          
          <li><a href="quick-recipes">Quick Recipes</a> </li>
          
          
          
          
          
          
          <li><a href="https://okera.zendesk.com/hc/en-us/categories/115000493607-FAQs" target="_blank">Frequently Asked Questions</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
        -->
    
    <li>
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2', title: 'On This Page' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 80);
  return false
})

});
</script>

<div id="toc"></div>

    </li>
    

</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            

<div class="post-content">

   

    


    

  <h1 id="2-okera-install---setting-up-the-deployment-manager">2. Okera Install - Setting Up the Deployment Manager</h1>

<!-- TOC depthFrom:2 depthTo:4 withLinks:1 updateOnSave:1 orderedList:0 -->

<ul>
  <li><a href="#install-the-aws-cli-tool">Install the AWS CLI Tool</a></li>
  <li><a href="#acquire-and-extract-the-dm-tarball">Acquire and Extract the DM Tarball</a></li>
  <li><a href="#acquire-the-okera-cli">Acquire the Okera CLI</a></li>
  <li><a href="#establish-dm-logging-and-install-paths">Establish DM Logging and Install Paths</a></li>
  <li><a href="#configure-the-deployment-manager">Configure the Deployment Manager</a></li>
  <li><a href="#dm-configuration-options">DM Configuration Options</a></li>
  <li><a href="#start-the-deployment-manager">Start the Deployment Manager</a></li>
  <li><a href="#deployment-manager-config-validator">Deployment Manager Config Validator</a></li>
</ul>

<!-- /TOC -->

<p>These steps configure the DeploymentManager which can manage all of your Okera clusters.
This set of steps is typically required once, to configure Okera to your environment.</p>

<h2 id="acquire-and-extract-the-dm-tarball">Acquire and Extract the DM Tarball</h2>

<p>Follow these steps to get the Deployment Manager tarball on the DM host.</p>

<ol>
  <li>Download and extract the Deployment Manager tarball.
    <ul>
      <li>The recommended download location is <code class="highlighter-rouge">/opt/okera</code>, but it can be downloaded to anywhere.</li>
    </ul>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mkdir <span class="nt">-p</span> /opt/okera <span class="o">&amp;&amp;</span> <span class="nb">cd</span> /opt/okera
</code></pre></div>    </div>
  </li>
  <li>
    <p>Update ownership of the destination directory.</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="sb">`</span>whoami<span class="sb">`</span> | xargs <span class="nt">-I</span> <span class="s1">'{}'</span> <span class="nb">sudo </span>chown <span class="nt">-R</span> <span class="s1">'{}'</span> /opt/okera
</code></pre></div>    </div>
  </li>
  <li>
    <p>Get the tarball from S3.</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-O</span> https://s3.amazonaws.com/okera-release-useast/1.3.4/deployment-manager-1.3.4.tar.gz
</code></pre></div>    </div>
  </li>
  <li>
    <p>Extract the bits.</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar </span>xzf deployment-manager-1.3.4.tar.gz <span class="o">&amp;&amp;</span> rm deployment-manager-1.3.4.tar.gz <span class="o">&amp;&amp;</span> ln <span class="nt">-sfn</span> deployment-manager-1.3.4 deployment-manager
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="acquire-the-okera-cli">Acquire the Okera CLI</h2>

<p>Perform this for any machine on which you want to run the Okera CLI tool.
Download the shell binary for either Linux or OS X (depending on which OS is running the CLI).</p>

<ul>
  <li><strong>Linux</strong></li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code> curl <span class="nt">-O</span> https://s3.amazonaws.com/okera-release-useast/1.3.4/cli/linux/ocadm <span class="o">&amp;&amp;</span> chmod +x ocadm
</code></pre></div></div>

<ul>
  <li><strong>OS X</strong></li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code> curl <span class="nt">-O</span> https://s3.amazonaws.com/okera-release-useast/1.3.4/cli/darwin/ocadm <span class="o">&amp;&amp;</span> chmod +x ocadm
</code></pre></div></div>

<h2 id="establish-dm-logging-and-install-paths">Establish DM Logging and Install Paths</h2>

<p>Configure the logging and local install directories.
These directories should be paths on the local file system.
The install directory should be restored if this machine is moved.
By default, the directories are <code class="highlighter-rouge">/var/log/okera</code> and <code class="highlighter-rouge">/etc/okera</code>.
The directories can be changed by setting <code class="highlighter-rouge">DEPLOYMENT_MANAGER_LOG_DIR</code> and <code class="highlighter-rouge">DEPLOYMENT_MANAGER_INSTALL_DIR</code> in the environment.</p>

<p><strong>Example:</strong> Creating the Logging and Install Directories</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mkdir <span class="nt">-p</span> /var/log/okera <span class="nb">sudo </span>mkdir <span class="nt">-p</span> /etc/okera
<span class="nb">sudo </span>chmod 700 /etc/okera
</code></pre></div></div>

<p>The Deployment Manager user needs exclusive access to those directories.
If the directories are created with a different user than the Deployment Manager user, run:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="sb">`</span>whoami<span class="sb">`</span> | xargs <span class="nt">-I</span> <span class="s1">'{}'</span> <span class="nb">sudo </span>chown <span class="nt">-R</span> <span class="s1">'{}'</span> /var/log/okera
<span class="nb">echo</span> <span class="sb">`</span>whoami<span class="sb">`</span> | xargs <span class="nt">-I</span> <span class="s1">'{}'</span> <span class="nb">sudo </span>chown <span class="nt">-R</span> <span class="s1">'{}'</span> /etc/okera
</code></pre></div></div>

<h3 id="configure-the-deployment-manager">Configure the Deployment Manager</h3>

<p>You must configure the Deployment Manager before it can be run.
The configuration is done by using environment variables and before starting up the server.
It is recommended that you copy the template configuration and update it.
The steps below assume that the standard install paths were used.</p>

<ol>
  <li>
    <p>Copy the Deployment Manager environment.</p>

    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp /opt/okera/deployment-manager/conf/env-template.sh /etc/okera/env.sh
</code></pre></div>    </div>
  </li>
  <li>
    <p>Open and edit <code class="highlighter-rouge">env.sh</code>, modifying it as necessary.</p>
  </li>
</ol>

<p>The config script from <code class="highlighter-rouge">/etc/okera/env.sh</code> is automatically loaded when starting the Deployment Manager.
If this is the path used, it is not necessary to source the script.
If any other path is used, <code class="highlighter-rouge">env.sh</code> must be sourced before starting the Deployment Manager.</p>

<ol>
  <li>Start (or restart) the deployment manager by running:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  /opt/okera/deployment-manager/bin/deployment-manager
</code></pre></div></div>

<h3 id="dm-configuration-options">DM Configuration Options</h3>

<p>Below are common available Okera configuration options.
They can be set as environment variables or in <code class="highlighter-rouge">/etc/okera/env.sh</code>, as explained above.
They are loaded when the Deployment Manager starts.</p>

<p>For additional Deployment Manager configuration options, see <a href="advanced-install#deployment-manager-configuration">Advanced Installation: DM Configs</a>.</p>

<h4 id="okera_s3_staging_dir">OKERA_S3_STAGING_DIR</h4>

<p>This directory is the <code class="highlighter-rouge">OKERA_S3_STAGING_DIR</code> for logs and install files.
It can exist anywhere in S3 that makes sense for your organization.
Okera creates in this directory a number of required subdirectories.</p>

<p><strong>Example:</strong> Setting the S3 staging directory</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_S3_STAGING_DIR</span><span class="o">=</span>s3://&lt;your_okera_dir&gt;
</code></pre></div></div>

<h4 id="relational-database-credentials">Relational Database Credentials</h4>

<p>The settings <code class="highlighter-rouge">OKERA_DB_URL</code>, <code class="highlighter-rouge">OKERA_DB_USERNAME</code>, and <code class="highlighter-rouge">OKERA_DB_PASSWORD</code> are the end point and credentials for the DM’s RDB backend.
The <code class="highlighter-rouge">OKERA_DB_URL</code> should be host:port (typically port <code class="highlighter-rouge">3306</code>) of the running MySQL/Aurora instance.</p>

<p><strong>Example:</strong> Setting the database location and credentials</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_DB_URL</span><span class="o">=</span>okera.xyzzzz.rds.amazonaws.com:3306
<span class="nb">export </span><span class="nv">OKERA_DB_USERNAME</span><span class="o">=</span>okera
<span class="nb">export </span><span class="nv">OKERA_DB_PASSWORD</span><span class="o">=</span>&lt;password&gt;
</code></pre></div></div>

<h4 id="okera_catalog_admins">OKERA_CATALOG_ADMINS</h4>

<p>ODAS clusters by default start up with one user which has admin on the system.
The admin users can create and manage roles, grant roles to other users and read all datasets.
This default user is the system user - the user that ODAS services use to authenticate itself and depends on how authentication was configured.</p>

<p>With <strong>Kerberos</strong>, the admin user is the first part of the kerberos principal.</p>

<p>When using <strong>JSON Web Tokens (JST)</strong>, the admin user is the subject in the <code class="highlighter-rouge">OKERA_SYSTEM_TOKEN</code>.</p>

<p>With no authentication, the admin user is ‘root’.
To specify other admin users, edit the comma-separated list of admin users and groups.</p>

<p><strong>Example:</strong> Setting the list of admin users and groups.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_CATALOG_ADMINS</span><span class="o">=</span>admin,username1,admin-group
</code></pre></div></div>

<p>Admins users can grant permissions to other users/groups including the ability to grant to other users.
However, only admin users can create new roles.</p>

<h4 id="okera_port_configuration">OKERA_PORT_CONFIGURATION</h4>

<p>This configuration specifies the ports on which cluster services run.
These ports must be available for all users connecting to Okera for metadata and data.
The ports are contained in a comma-separated list of service:portname:port number.
If the ports are not specified, Okera randomly selects available ports on which to expose these services.</p>

<p>Below are the ports that are required for clients.</p>

<ul>
  <li><code class="highlighter-rouge">cdas_rest_server:api</code></li>
  <li><code class="highlighter-rouge">cerebro_catalog:hms</code></li>
  <li><code class="highlighter-rouge">cerebro_catalog:sentry</code></li>
  <li><code class="highlighter-rouge">cerebro_planner:planner</code></li>
  <li><code class="highlighter-rouge">cerebro_web:webui</code></li>
  <li><code class="highlighter-rouge">cerebro_worker:worker</code></li>
  <li><code class="highlighter-rouge">kubernetes_dashboard:admin_ui</code></li>
  <li><code class="highlighter-rouge">grafana:ui</code></li>
</ul>

<p>An example configuration:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">OKERA_PORT_CONFIGURATION</span><span class="o">=</span><span class="s2">"okera_worker:worker:7185,cerebro_catalog:sentry:7182"</span>
<span class="nv">OKERA_PORT_CONFIGURATION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OKERA_PORT_CONFIGURATION</span><span class="s2">,cdas_rest_server:api:7184"</span>
<span class="nv">OKERA_PORT_CONFIGURATION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OKERA_PORT_CONFIGURATION</span><span class="s2">,okera_planner:planner:7183"</span>
<span class="nv">OKERA_PORT_CONFIGURATION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OKERA_PORT_CONFIGURATION</span><span class="s2">,okera_catalog:hms:7180"</span>
<span class="nv">OKERA_PORT_CONFIGURATION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OKERA_PORT_CONFIGURATION</span><span class="s2">,okera_web:webui:7186"</span>
<span class="nv">OKERA_PORT_CONFIGURATION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OKERA_PORT_CONFIGURATION</span><span class="s2">,grafana:ui:10000"</span>
<span class="nb">export </span><span class="nv">OKERA_PORT_CONFIGURATION</span><span class="o">=</span><span class="s2">"</span><span class="nv">$OKERA_PORT_CONFIGURATION</span><span class="s2">,kubernetes_dashboard:admin_ui:10001"</span>
</code></pre></div></div>

<h5 id="kerberos-configuration">Kerberos Configuration</h5>

<p>To enable Kerberos, specify these configurations:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">OKERA_KERBEROS_PRINCIPAL</code></p>

    <p>Principal for non-REST Okera services.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_KERBEROS_HTTP_PRINCIPAL</code></p>

    <p>Principal for REST Okera services.
 By convention, this configuration should start with <code class="highlighter-rouge">HTTP/</code> and is highly recommend for maintaining compatibility with existing tools.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_KERBEROS_KEYTAB_FILE</code></p>

    <p>Path to the keytab file containing both principals.
 This path should be accessible from the Deployment Manager, either on the local file system or in S3.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_KERBEROS_ENABLED_REALMS</code></p>

    <p>List of comma-separated cross realms from which to accept connections.
 This configuration does not need to be specified if only connections from the <code class="highlighter-rouge">OKERA_KERBEROS_PRINCIPAL</code> realm are allowed to connect.</p>
  </li>
</ul>

<p><strong>Example:</strong> Setting up Kerberos principal variables</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_KERBEROS_PRINCIPAL</span><span class="o">=</span><span class="s2">"okera/cname.example.com@REALM.com"</span>
<span class="nb">export </span><span class="nv">OKERA_KERBEROS_HTTP_PRINCIPAL</span><span class="o">=</span><span class="s2">"HTTP/cname.example.com@REALM.com"</span>
<span class="nb">export </span><span class="nv">OKERA_KERBEROS_KEYTAB_FILE</span><span class="o">=</span><span class="s2">"/etc/okera.keytab"</span>
</code></pre></div></div>

<p>For more information on how to set up a Kerberized cluster, see <a href="kerberos-cluster-setup">Kerberos Cluster Setup</a>.</p>

<h5 id="json-web-tokens-jwt-configuration">JSON Web Tokens (JWT) Configuration</h5>

<p>To enable authentication using JSON Web Tokens (JWT), specify these configurations:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">OKERA_JWT_PUBLIC_KEY</code></p>

    <p>Path to the public key to decrypt tokens.
 It must be accessible on the Deployment Manager machine, but can be on the local machine or in S3.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_JWT_ALGORITHM</code></p>

    <p>Algorithm used to decrypt tokens.
 Must be set to <code class="highlighter-rouge">RSA256</code> or <code class="highlighter-rouge">RSA512</code>.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_JWT_AUTHENTICATION_SERVER_URL</code></p>

    <p>URL used to authenticate JWT tokens.
 A POST call is issued to this URL, specifying the token to authenticate.
 This cannot be set if the <code class="highlighter-rouge">OKERA_JWT_PUBLIC_KEY</code> is set.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_SYSTEM_TOKEN</code></p>

    <p>Path to a file that contains the token (on a single line) that Okera services uses to authenticate itself.
 The subject for this token acts as the Okera system user.</p>
  </li>
</ul>

<p><strong>Example:</strong> Setting the JWT token variables with a local path</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_JWT_PUBLIC_KEY</span><span class="o">=</span><span class="s2">"/etc/jwt.512.pub"</span>
<span class="nb">export </span><span class="nv">OKERA_JWT_ALGORITHM</span><span class="o">=</span><span class="s2">"RSA512"</span>
</code></pre></div></div>

<p><strong>Example:</strong> Setting the JWT token variables for a REST call and a token to pass</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_JWT_AUTHENTICATION_SERVER_URL</span><span class="o">=</span><span class="s2">"http://sso/verify-token"</span>
<span class="nb">export </span><span class="nv">OKERA_SYSTEM_TOKEN</span><span class="o">=</span><span class="s2">"/etc/okera.token"</span>
</code></pre></div></div>

<p>For more about authentication with JWTs, see <a href="odas-authentication#json-web-tokens">ODAS Authentication</a>.</p>

<h5 id="https-configuration">HTTPS Configuration</h5>

<p>To enable HTTPS, specify the SSL certificate and private key that Okera uses.
Setting the certificate and key enables HTTPS on the REST server and Web UI.</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">OKERA_SSL_CERTIFICATE_FILE</code></p>

    <p>Path to the certificate file.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_SSL_KEY_FILE</code></p>

    <p>Path to the file with the private key.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_SSL_FQDN</code> (optional)</p>

    <p>Fully qualified domain name for the cluster.
 If set, this must be a valid “Subject Alternate Name” in the certificate.
 This can be the fully qualified domain name for any node in this cluster (typically the CNAME for the REST service).
 This is required for some clients, which often do not allow navigating IP addresses with SSL is enabled, such as newer versions of Chrome.</p>
  </li>
</ul>

<p><strong>Example:</strong> Setting the HTTPS environment variables</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_SSL_CERTIFICATE_FILE</span><span class="o">=</span>/etc/okera.cert
<span class="nb">export </span><span class="nv">OKERA_SSL_KEY_FILE</span><span class="o">=</span>/etc/okera.key
<span class="nb">export </span><span class="nv">OKERA_SSL_FQDN</span><span class="o">=</span>rest-server.okera.com
</code></pre></div></div>

<h5 id="ldap-configuration">LDAP Configuration</h5>

<p>For information on how to set LDAP Basic Auth related environment variables, see <a href="secure-okera-rest-api-ldap#setting-up-ldap-related-configurations">LDAP Basic Auth</a>.</p>

<p>For more details on interactions with authenticated Okera, see:</p>

<ul>
  <li><a href="odas-authentication">Authentication</a></li>
  <li><a href="secure-deployment-manager-rest-api">Security</a></li>
</ul>

<h5 id="oauth-configuration">OAuth Configuration</h5>

<p>Okera can be deployed with OAuth enabled for easier Web UI login. For more information, see</p>

<ul>
  <li><a href="secure-okera-rest-api-oauth">OAuth Guide</a>.</li>
</ul>

<h5 id="shared-cookie-configuration">Shared Cookie Configuration</h5>

<p>The Okera Web Portal can be configured to use shared cookies for authentication.
For this to work, Okera needs to be configured with the shared cookie name and the shared cookie domain.
The following environment variables need to be set either on the Deployment Manager or on the <code class="highlighter-rouge">cerebro_web:webui</code> container.</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">OKERA_SHARED_COOKIE_NAME</code></p>

    <p>The name of the cookie that contains the login token.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">OKERA_SHARED_COOKIE_DOMAIN</code></p>

    <p>The full name of the (sub)domain on which <code class="highlighter-rouge">OKERA_SHARED_COOKIE_NAME</code> is shared.
This value will be passed verbatim to the browser’s cookie domain.</p>
  </li>
</ul>

<p><strong>Example:</strong> Setting the Shared Cookie values</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_SHARED_COOKIE_NAME</span><span class="o">=</span>my_company_token
<span class="nb">export </span><span class="nv">OKERA_SHARED_COOKIE_DOMAIN</span><span class="o">=</span>subdomain1.example.com
</code></pre></div></div>

<p>Given the above example, the Okera Web Portal will attempt to read the cookie named <code class="highlighter-rouge">my_company_token</code> for a value assumed to be the token.
The Okera Web Portal must be hosted on <code class="highlighter-rouge">subdomain1.example.com</code> or a subdomain of it in order to read that value.
Additionally, if the Okera Web Portal generates a new token, it will write it to the <code class="highlighter-rouge">my_company_token</code> cookie, sharing it across <code class="highlighter-rouge">subdomain1.example.com</code>.</p>

<h3 id="start-the-deployment-manager">Start the Deployment Manager</h3>

<p>After setting the environment variables and sourcing them, start the Deployment Manager.</p>

<p><strong>Example:</strong> Deployment Manager startup</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/okera/deployment-manager/bin/deployment-manager
</code></pre></div></div>

<p>This should output <code class="highlighter-rouge">System up and running</code> and the server hostport.</p>

<blockquote>
  <p><strong>Note:</strong> This step is not expected to take more than 30 seconds.
It usually indicates a configuration issue if the Deployment Manager does not come up in a reasonable amount of time.</p>
</blockquote>

<p>The Deployment Manager runs as a daemon
Its logs can be viewed by entering:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>less /var/log/okera/deployment-manager.log
</code></pre></div></div>

<p>Any configuration issues should be visible at the end of the log.</p>

<h4 id="deployment-manager-config-validator">Deployment Manager Config Validator</h4>

<p>It is possible to run the Deployment Manager config validation without restarting the Deployment Manager process.
This is convenient to test new configs or to quickly diagnose problematic configs.</p>

<p>To run the Deployment Manager config validation without restarting the Deployment Manager, run the deployment-manager script with the <code class="highlighter-rouge">verify-configs-only</code> argument.</p>

<p><strong>Example:</strong> Validating a DM config without starting the DM</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/okera/deployment-manager/bin/deployment-manager verify-configs-only
...
<span class="k">*************************************************************</span>
  Config validation successful.
<span class="k">*************************************************************</span>
</code></pre></div></div>

<h3 id="configure-ocadm">Configure ocadm</h3>

<p>Configure ocadm to connect with a running Deployment Manager.</p>

<p>Run the following:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/ocadm configure <span class="nt">--server</span> &lt;DM_host:port&gt;
/opt/ocadm status
</code></pre></div></div>

<p>Running the <code class="highlighter-rouge">status</code> command should return the result:
<code class="highlighter-rouge">Service available. Status: Running.</code></p>

<h2 id="next">Next</h2>

<p>Now you’re ready to <a href="install-odas">create a cluster</a>.</p>


    <div class="tags">
        
    </div>




</div>



<footer>
  <div class="row">
    <div class="col-lg-12 footer">
      <div class="footer-meta">
        &copy;2019 Okera, Inc. All rights reserved.  Site last generated: Mar 28, 2019
      </div>
    </div>
  </div>
</footer>

        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
