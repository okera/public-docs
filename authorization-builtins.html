<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Authorization Builtins | Okera User Documentation</title>
<link rel="stylesheet" href="theme/css/syntax.css">
<link rel="icon" type="image/png" href="/assets/images/icon-favicon32.png">

<script src="https://use.fontawesome.com/d9343c4626.js"></script>

<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="theme/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
  crossorigin="anonymous">
<!-- Old Algolia Instant Search -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css"> -->
<!-- End Old Algolia Instant Search -->
<link rel="stylesheet" href="theme/css/asciidoctor.css">
<link rel="stylesheet" href="theme/css/custom.css">
<link rel="stylesheet" href="theme/css/boxshadowproperties.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="theme/js/jquery.navgoco.min.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
  crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="theme/js/toc.js"></script>
<script src="theme/js/customscripts.js"></script>

<!-- Old Algolia Instant Search -->
<!-- <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script> -->
<!-- End Old Algolia Instant Search -->

<!-- Include AlgoliaSearch JS Client and autocomplete.js library -->
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>

<script>
  $(document).ready(function () {
    $("blockquote:contains('Note')").addClass("admonitionblock note");
    $("blockquote:contains('Warning')").addClass("admonitionblock warning");
    $("blockquote:contains('Tip')").addClass("admonitionblock tip");
    $(".admonitionblock.note").prepend('<i class="fa fa-check admonition"></i>');
    $(".admonitionblock.warning").prepend('<i class="fa fa-exclamation-triangle admonition"></i>');
    $(".admonitionblock.tip").prepend('<i class="fa fa-lightbulb-o admonition"></i>');
  });
</script>


<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">

        <div class="row">
            <div class="col-sm-4 col-md-3">

                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <div class="navbar-wordmark">
                        <a href="/">
                            <img src="assets/images/okera-wordmark-white.svg" alt="Okera wordmark" />
                        </a>
                    </div>
                </div>

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

                    <ul class="nav navbar-nav">
                        <!-- toggle sidebar button -->
                        <!-- <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li> -->
                        <!-- entries without drop-downs appear here -->

                            
                        <li>
                            <a href="https://okera.com" target="_blank">okera.com</a>
                        </li>
                          
                        <!-- entries with drop-downs appear here -->
                        <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                         
                    </ul>
                </div>
            </div>
            <form class="aa-input-container navbar-form" id="aa-input-container" role="search">
                <div class="form-group">
                    <input id="aa-search-input" type="text" class="aa-input-search form-control" placeholder="Search"
                        autocomplete="off">
                </div>
            </form>
        </div>
        <!-- Algolia Integrated search Script -->
        <script type="text/javascript" src="theme/js/okera-integrated-search.js"></script>
        <!-- comment out this block if you want to hide jekyll search
                  <div class="navbar-form" id="search-demo-container">
                      <form action="/search" method="GET">
                      <input type="text" name="q" id="search-input" placeholder="Search the docs...">
                      </form>
                  </div>
                end search -->
    </div>
</nav>
<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                


<ul id="mysidebar" class="nav affix">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a href="#">Introduction to Okera</a>
      <ul>
          
          
          
          <li><a href="product-overview">Product Overview</a> </li>
          
          
          
          
          
          
          <li><a href="odas-overview">Okera Data Access Service Overview</a> </li>
          
          
          
          
          
          
          <li><a href="catalog-overview">Okera Catalog Overview</a> </li>
          
          
          
          
          
          
          <li><a href="okera-architecture-overview">Platform Architecture Overview</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Installing Okera</a>
      <ul>
          
          
          
          <li><a href="getting-started">Getting Started</a> </li>
          
          
          
          
          
          
          <li><a href="install">Installation Overview</a> </li>
          
          
          
          
          
          
          <li><a href="install-prereqs">Installation Prerequisites</a> </li>
          
          
          
          
          
          
          <li><a href="install-dm">Setting up the Deployment Manager</a> </li>
          
          
          
          
          
          
          <li><a href="install-odas">Setting up the ODAS Cluster</a> </li>
          
          
          
          
          
          
          <li><a href="advanced-install">Advanced Installation Options</a> </li>
          
          
          
          
          
          
          <li><a href="awsguide">AWS Guide</a> </li>
          
          
          
          
          
          
          <li><a href="odas-authentication">Authentication Guide</a> </li>
          
          
          
          
          
          
          <li><a href="kerberos-cluster-setup">Kerberos</a> </li>
          
          
          
          
          
          
          <li><a href="secure-okera-rest-api-ldap">LDAP Authentication</a> </li>
          
          
          
          
          
          
          <li><a href="secure-okera-rest-api-oauth">OAuth Authentication</a> </li>
          
          
          
          
          
          
          <li><a href="secure-deployment-manager-rest-api">Deployment Manager REST Security</a> </li>
          
          
          
          
          
          
          <li><a href="support-versions">Versions</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Administering ODAS Clusters</a>
      <ul>
          
          
          
          <li><a href="cluster-administration">Cluster Administration</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-types">Cluster Types</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-sizing">Cluster Sizing</a> </li>
          
          
          
          
          
          
          <li><a href="memory-usage">Platform Memory Usage</a> </li>
          
          
          
          
          
          
          <li><a href="ip-address-management">IP Address Management</a> </li>
          
          
          
          
          
          
          <li><a href="kubernetes-dashboard-quickstart">Cluster Monitoring with Kubernetes Addons</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-launch-plugin-api">Cluster Launch API</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Using the Catalog</a>
      <ul>
          
          
          
          <li><a href="authorization">Role-based Access Control</a> </li>
          
          
          
          
          
          
          <li><a href="privileges">Privileges</a> </li>
          
          
          
          
          
          
          <li><a href="schema-design">Schema Design</a> </li>
          
          
          
          
          
          
          <li class="active"><a href="authorization-builtins">Authorization Builtin Functions</a></li>
          
          
          
          
          
          
          <li><a href="auditing">Auditing</a> </li>
          
          
          
          
          
          
          <li><a href="okera-database-cli">Database CLI</a> </li>
          
          
          
          
          
          
          <li><a href="supported-sql">Supported SQL</a> </li>
          
          
          
          
          
          
          <li><a href="jdbc-data-source">JDBC Data Source</a> </li>
          
          
          
          
          
          
          <li><a href="data-types">Supported Data Types</a> </li>
          
          
          
          
          
          
          <li><a href="complex-types">Complex Data Types</a> </li>
          
          
          
          
          
          
          <li><a href="extending-odas">Extending ODAS</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Using the Web UI</a>
      <ul>
          
          
          
          <li><a href="web-ui-basics">Okera Portal Basics</a> </li>
          
          
          
          
          
          
          <li><a href="datasets-page">Datasets Page</a> </li>
          
          
          
          
          
          
          <li><a href="permissions-page">Permissions Page</a> </li>
          
          
          
          
          
          
          <li><a href="reports-page">Reports Page</a> </li>
          
          
          
          
          
          
          <li><a href="web-ui-admin">Okera Portal for Admins</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Integrating with ODAS</a>
      <ul>
          
          
          
          <li><a href="catalog-rest-api">REST API</a> </li>
          
          
          
          
          
          
          <li><a href="client-configs">Client Configuration</a> </li>
          
          
          
          
          
          
          <li><a href="hive-best-practices">Hive Integration - Best Practices</a> </li>
          
          
          
          
          
          
          <li><a href="emr-integration">EMR Integration</a> </li>
          
          
          
          
          
          
          <li><a href="pyokera">Native Python Integration</a> </li>
          
          
          
          
          
          
          <li><a href="client-integration">Client Integration</a> </li>
          
          
          
          
          
          
          <li><a href="planner-integration">Planner Integration</a> </li>
          
          
          
          
          
          
          <li><a href="third-party-integration">Third-Party Integration</a> </li>
          
          
          
          
          
          
          <li><a href="odas-cdh-integration">CDH Integration</a> </li>
          
          
          
          
          
          
          <li><a href="tableau-web-data-connector">Tableau Integration</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Reference</a>
      <ul>
          
          
          
          <li><a href="release-notes">Release Notes</a> </li>
          
          
          
          
          
          
          <li><a href="earlier-release-notes">Earlier Release Notes</a> </li>
          
          
          
          
          
          
          <li><a href="service-port-assignments">Service Ports</a> </li>
          
          
          
          
          
          
          <li><a href="s3-encryption-support">Supported S3 Encryption Types</a> </li>
          
          
          
          
          
          
          <li><a href="compatibility-guarantees">Compatibility Guarantees</a> </li>
          
          
          
          
          
          
          <li><a href="quick-recipes">Quick Recipes</a> </li>
          
          
          
          
          
          
          <li><a href="https://okera.zendesk.com/hc/en-us/categories/115000493607-FAQs" target="_blank">Frequently Asked Questions</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
        -->
    
    <li>
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2', title: 'On This Page' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 80);
  return false
})

});
</script>

<div id="toc"></div>

    </li>
    

</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            

<div class="post-content">

   

    


    

  <h1 id="authorization-builtins">Authorization Builtins</h1>

<p>ODAS supports authorization builtins to facilitate implementing fine grained access control.
While these primitives are not strictly needed, they allow creating more expressive views.
This can greatly improve usability for data consumers and stewards.</p>

<p>These builtins are intended to be used to implement the access control views from the <a href="schema-design">schema design best practices</a>.
They are a family of builtins, that return true or false, depending on the authenticated user.
These builtins otherwise behave like all ODAS builtins, meaning they can be used anywhere an expression can be used in the SQL statement.
This includes for example, in the SELECT list, as a WHERE clause, or as a JOIN condition.
These builtins can also be used with other expressions.</p>

<p>We’ll first describe the builtins in detail, and then a few examples of how we expect them to be used.</p>

<h2 id="builtins">Builtins</h2>

<p><strong>has_access(STRING)</strong></p>

<p><code class="highlighter-rouge">has_access</code> takes a list of a comma-separated catalog paths and returns true if the user has SELECT access to all of them.
The paths can be <code class="highlighter-rouge">db</code> or <code class="highlighter-rouge">db.table</code>.
As usual, catalog paths are not case sensitive.</p>

<p>For example</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">has_access</span><span class="p">(</span><span class="s1">'prod_db'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'True'</span> <span class="c1">-- If the user has access to all of prod db</span>
<span class="k">SELECT</span> <span class="n">has_access</span><span class="p">(</span><span class="s1">'prod_db.sales_data'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'True'</span> <span class="c1">-- If the user has access to this table (or view)</span>

<span class="c1">-- To query multiple catalog objects:</span>
<span class="k">SELECT</span> <span class="n">has_access</span><span class="p">(</span><span class="s1">'prod_db1,prod_db2'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'True'</span> <span class="c1">-- If the user has access to both databases.</span>
</code></pre></div></div>

<p><strong>has_roles(STRING)</strong></p>

<p><code class="highlighter-rouge">has_roles</code> takes a list of a comma-separated roles and returns true if the user has all of the roles.
As usual, role names are not case sensitive.</p>

<p>For example</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">has_roles</span><span class="p">(</span><span class="s1">'admin_role'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'True'</span> <span class="c1">-- If the user has the admin role.</span>
<span class="k">SELECT</span> <span class="n">has_roles</span><span class="p">(</span><span class="s1">'steward_role,analyst_role'</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">'True'</span> <span class="c1">-- If the user has both roles.</span>
</code></pre></div></div>

<h2 id="expected-usage">Expected usage</h2>

<p>The primary expected use for these builtins is to express dynamic views where the view definition varies based on the user.
This gives the benefit of allowing different users to query the same view by name as well consolidating as what would have been multiple views, which simplifies policy management.</p>

<p>A few common examples:</p>

<p><strong>Tokenize a column if the user does not have access to the base table</strong></p>

<p>In this case, we want to enforce the policy where users with access to the base table see the full value, but users without see the column tokenized.
We could create this view by:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">VIEW</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">users_secure</span> <span class="k">AS</span> <span class="k">SELECT</span>
  <span class="n">uid</span><span class="p">,</span>
  <span class="n">dob</span><span class="p">,</span>
  <span class="n">gender</span><span class="p">,</span>
  <span class="n">if</span> <span class="p">(</span><span class="n">has_access</span><span class="p">(</span><span class="s1">'okera_sample.users'</span><span class="p">),</span> <span class="n">ccn</span><span class="p">,</span> <span class="n">mask_ccn</span><span class="p">(</span><span class="n">uid</span><span class="p">))</span> <span class="k">as</span> <span class="s1">'ccn'</span>
<span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">users</span>
</code></pre></div></div>

<p>This creates a view, <code class="highlighter-rouge">okera_sample.users_secure</code>.
Users that have access to the base table, <code class="highlighter-rouge">okera_sample.users</code>, are allowed to see the credit card column (<code class="highlighter-rouge">ccn</code>) but users without only see it after masking.
Per the schema design best practices, all users and applications should read from this view.</p>

<p><strong>Implement row level filter based on user roles</strong></p>

<p>In this example, we will construct a view which based on the user’s roles, will only show a subset of the rows.
This can be used to implement policies such as having a particular user be able to see sales data from Germany, another user from Great Britain and a third user being able to see both.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">VIEW</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">sales_data_secure</span> <span class="k">AS</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">sales_data</span> <span class="k">WHERE</span>
  <span class="n">has_roles</span><span class="p">(</span><span class="s1">'de_role'</span><span class="p">)</span> <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'de'</span> <span class="k">OR</span>
  <span class="n">has_roles</span><span class="p">(</span><span class="s1">'gbr_role'</span><span class="p">)</span> <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'gbr'</span>
</code></pre></div></div>

<p>Users that have the <code class="highlighter-rouge">de_role</code> will be able to see all data where the country is <code class="highlighter-rouge">de</code>.
Users that have the <code class="highlighter-rouge">grb_role</code> will be able to see all data where the country is <code class="highlighter-rouge">gbr</code>.
Users that have both, will be able to see both.</p>

<p>Both builtins can also be used together:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">VIEW</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">sales_data_secure</span> <span class="k">AS</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">sales_data</span> <span class="k">WHERE</span>
  <span class="n">has_roles</span><span class="p">(</span><span class="s1">'de_role'</span><span class="p">)</span> <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'de'</span> <span class="k">OR</span>
  <span class="n">has_roles</span><span class="p">(</span><span class="s1">'gbr_role'</span><span class="p">)</span> <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'gbr'</span> <span class="k">OR</span>
  <span class="n">has_access</span><span class="p">(</span><span class="s1">'okera_sample.samples_data'</span><span class="p">)</span>
</code></pre></div></div>

<p>This is similar to the above, except users that have access to the base table have full access.</p>

<h2 id="performance-impact">Performance impact</h2>

<p>In the cases above, where the input to the builtins is constant (they are catalog objects names or role names), this has no runtime cost.
The ODAS engine does constant folding at planning time and the access check is fully resolved during planning.</p>

<p>In the tokenization example, as part of constant folding, the query gets transformed:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>
  <span class="n">uid</span><span class="p">,</span>
  <span class="n">dob</span><span class="p">,</span>
  <span class="n">gender</span><span class="p">,</span>
  <span class="n">if</span> <span class="p">(</span><span class="n">has_access</span><span class="p">(</span><span class="s1">'okera_sample.users'</span><span class="p">),</span> <span class="n">ccn</span><span class="p">,</span> <span class="n">mask_ccn</span><span class="p">(</span><span class="n">uid</span><span class="p">))</span>
<span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">users</span><span class="p">;</span>

<span class="c1">-- Becomes</span>
<span class="k">SELECT</span>
  <span class="n">uid</span><span class="p">,</span>
  <span class="n">dob</span><span class="p">,</span>
  <span class="n">gender</span><span class="p">,</span>
  <span class="n">if</span> <span class="p">(</span><span class="k">true</span><span class="p">,</span> <span class="n">ccn</span><span class="p">,</span> <span class="n">mask_ccn</span><span class="p">(</span><span class="n">uid</span><span class="p">))</span>
<span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">users</span><span class="p">;</span>

<span class="c1">-- Becomes</span>
<span class="k">SELECT</span>
  <span class="n">uid</span><span class="p">,</span>
  <span class="n">dob</span><span class="p">,</span>
  <span class="n">gender</span><span class="p">,</span>
  <span class="n">ccn</span>
<span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">users</span><span class="p">;</span>
</code></pre></div></div>

<p>The result is exactly the query we want to execute when reading data.</p>

<p>Similar in the row filtering example, for a user that just has the <code class="highlighter-rouge">gbr_role</code>:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">sales_data</span>
<span class="k">WHERE</span>
  <span class="n">has_roles</span><span class="p">(</span><span class="s1">'de_role'</span><span class="p">)</span> <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'de'</span> <span class="k">OR</span>
  <span class="n">has_roles</span><span class="p">(</span><span class="s1">'gbr_role'</span><span class="p">)</span> <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'gbr'</span>

<span class="c1">-- Becomes</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">sales_data</span>
<span class="k">WHERE</span>
  <span class="k">false</span> <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'de'</span> <span class="k">OR</span>
  <span class="k">true</span> <span class="k">AND</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'gbr'</span>

<span class="c1">-- Becomes</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">sales_data</span>
<span class="k">WHERE</span>
  <span class="k">false</span> <span class="k">OR</span>
  <span class="n">country</span> <span class="o">=</span> <span class="s1">'gbr'</span>

<span class="c1">-- Becomes</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">okera_sample</span><span class="p">.</span><span class="n">sales_data</span>
<span class="k">WHERE</span>
  <span class="n">country</span> <span class="o">=</span> <span class="s1">'gbr'</span>
</code></pre></div></div>

<p>Note again that all of these transformations happen entirely at planning time and have zero per-record overhead.</p>


    <div class="tags">
        
    </div>




</div>



<footer>
  <div class="row">
    <div class="col-lg-12 footer">
      <div class="footer-meta">
        &copy;2019 Okera, Inc. All rights reserved.  Site last generated: Mar 26, 2019
      </div>
    </div>
  </div>
</footer>

        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
