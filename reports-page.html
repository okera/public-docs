<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Reports Page | Okera User Documentation</title>
<link rel="stylesheet" href="theme/css/syntax.css">
<link rel="icon" type="image/png" href="/assets/images/icon-favicon32.png">

<script src="https://use.fontawesome.com/d9343c4626.js"></script>

<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="theme/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">
<link rel="stylesheet" href="theme/css/asciidoctor.css">
<link rel="stylesheet" href="theme/css/custom.css">
<link rel="stylesheet" href="theme/css/boxshadowproperties.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="theme/js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="theme/js/toc.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<script src="theme/js/customscripts.js"></script>

<script>
$( document ).ready(function() {
  $( "blockquote:contains('Note')" ).addClass( "admonitionblock note" );
  $( "blockquote:contains('Warning')" ).addClass( "admonitionblock warning" );
  $( "blockquote:contains('Tip')" ).addClass( "admonitionblock tip" );
  $( ".admonitionblock.note" ).prepend( '<i class="fa fa-check admonition"></i>' );
  $( ".admonitionblock.warning" ).prepend( '<i class="fa fa-exclamation-triangle admonition"></i>' );
  $( ".admonitionblock.tip" ).prepend( '<i class="fa fa-lightbulb-o admonition"></i>' );
});
</script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="navbar-wordmark"><a href="/">
              <img src="assets/images/okera-wordmark-white.png" alt="Okera wordmark" /></a>
            </div>

        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <!-- <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li> -->
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="search">Search</a></li>
                
                
                
                <li><a href="https://www.okera.com/blog" target="_blank">Okera Blog</a></li>
                
                
                
                <li><a href="https://okera.com" target="_blank">okera.com</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <!-- comment out this block if you want to hide search
                <li class="dropdown">

                  <div id="search-demo-container">
                      <form action="/search" method="GET">
                      <input type="text" name="q" id="search-input" placeholder="Search the docs...">
                      </form>
                  </div>

                </li>
                end search -->
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                


<ul id="mysidebar" class="nav affix">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a href="#">Introduction to Okera</a>
      <ul>
          
          
          
          <li><a href="product-overview">Product Overview</a> </li>
          
          
          
          
          
          
          <li><a href="odas-overview">Okera Data Access Service Overview</a> </li>
          
          
          
          
          
          
          <li><a href="catalog-overview">Okera Catalog Overview</a> </li>
          
          
          
          
          
          
          <li><a href="okera-architecture-overview">Platform Architecture Overview</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Installing the Deployment Manager</a>
      <ul>
          
          
          
          <li><a href="getting-started">Getting Started</a> </li>
          
          
          
          
          
          
          <li><a href="install">Installation Guide</a> </li>
          
          
          
          
          
          
          <li><a href="advanced-install">Advanced Installation Options</a> </li>
          
          
          
          
          
          
          <li><a href="odas-authentication">Authentication Guide</a> </li>
          
          
          
          
          
          
          <li><a href="kerberos-cluster-setup">Kerberos</a> </li>
          
          
          
          
          
          
          <li><a href="secure-okera-rest-api-ldap">LDAP Authentication</a> </li>
          
          
          
          
          
          
          <li><a href="secure-okera-rest-api-oauth">OAuth Authentication</a> </li>
          
          
          
          
          
          
          <li><a href="secure-deployment-manager-rest-api">Deployment Manager REST Security</a> </li>
          
          
          
          
          
          
          <li><a href="support-versions">Versions</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Administering ODAS Clusters</a>
      <ul>
          
          
          
          <li><a href="cluster-administration">Cluster Administration</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-types">Cluster Types</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-sizing">Cluster Sizing</a> </li>
          
          
          
          
          
          
          <li><a href="memory-usage">Platform Memory Usage</a> </li>
          
          
          
          
          
          
          <li><a href="ip-address-management">IP Address Management</a> </li>
          
          
          
          
          
          
          <li><a href="kubernetes-dashboard-quickstart">Cluster Monitoring with Kubernetes Addons</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-launch-plugin-api">Cluster Launch API</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Using the Catalog</a>
      <ul>
          
          
          
          <li><a href="authorization">Authorization Guide</a> </li>
          
          
          
          
          
          
          <li><a href="schema-design">Schema Design</a> </li>
          
          
          
          
          
          
          <li><a href="authorization-builtins">Authorization Builtin Functions</a> </li>
          
          
          
          
          
          
          <li><a href="auditing">Auditing</a> </li>
          
          
          
          
          
          
          <li><a href="okera-database-cli">Database CLI</a> </li>
          
          
          
          
          
          
          <li><a href="supported-sql">Supported SQL</a> </li>
          
          
          
          
          
          
          <li><a href="jdbc-data-source">JDBC Data Source</a> </li>
          
          
          
          
          
          
          <li><a href="data-types">Supported Data Types</a> </li>
          
          
          
          
          
          
          <li><a href="complex-types">Complex Data Types</a> </li>
          
          
          
          
          
          
          <li><a href="extending-odas">Extending ODAS</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Using the Web UI</a>
      <ul>
          
          
          
          <li><a href="web-ui-basics">Okera Portal Basics</a> </li>
          
          
          
          
          
          
          <li><a href="datasets-page">Datasets Page</a> </li>
          
          
          
          
          
          
          <li><a href="permissions-page">Permissions Page</a> </li>
          
          
          
          
          
          
          <li class="active"><a href="reports-page">Reports Page</a></li>
          
          
          
          
          
          
          <li><a href="web-ui-admin">Okera Portal for Admins</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Integrating with ODAS</a>
      <ul>
          
          
          
          <li><a href="catalog-rest-api">REST API</a> </li>
          
          
          
          
          
          
          <li><a href="client-configs">Client Configuration</a> </li>
          
          
          
          
          
          
          <li><a href="emr-integration">EMR Integration</a> </li>
          
          
          
          
          
          
          <li><a href="pyokera">Native Python Integration</a> </li>
          
          
          
          
          
          
          <li><a href="client-integration">Client Integration</a> </li>
          
          
          
          
          
          
          <li><a href="planner-integration">Planner Integration</a> </li>
          
          
          
          
          
          
          <li><a href="third-party-integration">Third-Party Integration</a> </li>
          
          
          
          
          
          
          <li><a href="odas-cdh-integration">CDH Integration</a> </li>
          
          
          
          
          
          
          <li><a href="tableau-web-data-connector">Tableau Integration</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Reference</a>
      <ul>
          
          
          
          <li><a href="release-notes">Release Notes</a> </li>
          
          
          
          
          
          
          <li><a href="earlier-release-notes">Earlier Release Notes</a> </li>
          
          
          
          
          
          
          <li><a href="service-port-assignments">Service Ports</a> </li>
          
          
          
          
          
          
          <li><a href="quick-recipes">Quick Recipes</a> </li>
          
          
          
          
          
          
          <li><a href="faq">Frequently Asked Questions</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
    
    <li>
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2', title: 'On This Page' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    </li>
    

</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            

<div class="post-content">

   

    


    

  <h1 id="reports-page">Reports Page</h1>
<p>The Okera Portal provides a <code class="highlighter-rouge">Reports</code> page for users with admin privileges to view metrics on datasets for which they are admins.
The <code class="highlighter-rouge">Reports</code> page is driven from the Okera audit logs, which contain information on everything that happens in the Okera system (for more on the structure of the audit logs, see <a href="auditing">Auditing</a>). 
Reports show various usage statistics over a recent time period including number of queries over time, number of queries per dataset, number of queries per application, and top users querying those datasets.</p>

<p>By default users will see aggregated metrics over all of their datasets over the past 24 hours, but it is possible to filter by database and pick a different time range.</p>

<p>Users who do not have admin privileges on any dataset will not see the <code class="highlighter-rouge">Reports</code> tab.</p>

<h2 id="filtering-by-database">Filtering by database</h2>
<p>By default <code class="highlighter-rouge">Reports</code> will show aggregated metrics for all of the datasets on which the current user has admin privileges.
You can change which database or set of databases the reports show using the multi-select dropdown in the top right of the page labelled “My admin databases”.
As the label implies, this dropdown contains a list of the databases in which you are the admin for at least one dataset.
Selecting a database or multiple databases will cause the page to generate reports that include only the datasets for which you are admin in the selected databases.</p>

<h2 id="changing-the-time-range">Changing the time range</h2>
<p>The default time range on the <code class="highlighter-rouge">Reports</code> page is “Last 24 hours”.
This means that every report on the page will be showing data only for queries that occured in the 24 hours prior to the page visit.
Using the dropdown labeled “Select a time range” you can change the timerange used to generate the reports to one of the following options:</p>
<ul>
  <li><strong>Last 24 hours (default)</strong>: reports will show data from the 24 hours prior to visiting the page.</li>
  <li><strong>Last 7 days</strong>: reports will show data for 7 days prior to visiting the page.</li>
  <li><strong>Today</strong>: reports will show data for the current calendar day.</li>
  <li><strong>Yesterday</strong>: reports will show data for the calendar day prior to the current day.</li>
</ul>

<h2 id="drilldowns">Drilldowns</h2>
<p>Each report in the <code class="highlighter-rouge">Reports</code> page supports drilling down on the data to open a query in <code class="highlighter-rouge">Workspace</code>.
This allows users to explore the underlying data powering the reports and enables them to modify the query to find other insights.
Each report has a slightly different drilldown query, but they all follow a similar pattern of a base query restricted by time, followed by additional constraints. For example, the drilldown for “Number of queries by dataset” looks like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from okera_system.reporting_audit_logs
  where ymd&gt;='2018-08-12' and ymd&lt;='2018-08-13'
  and start_unix_time&gt;=1534113600000 and start_unix_time&lt;=1534200600000
  and client_application like 'hive%'
</code></pre></div></div>
<p>There are a few things to note about this query:</p>
<ul>
  <li>We are selecting from <code class="highlighter-rouge">okera_system.reporting_audit_logs</code>, this is a special system view that has permissions so users will only see data for datasets on which they have admin privileges.</li>
  <li>We are restricting by <code class="highlighter-rouge">ymd</code> <strong>and</strong> <code class="highlighter-rouge">start_unix_time</code>. This seems redundant, but it helps performance by first choosing the right partition, then restricting data further based on timestamps.</li>
  <li>Finally, the query restricts to all client applications starting with <code class="highlighter-rouge">hive</code>.
This is to capture all versions of “hive”.</li>
  <li>Timestamps are UTC timestamps in milliseconds.</li>
</ul>

<p>To run the query, click <code class="highlighter-rouge">Run</code>.
You will see the audit log data for the specified time range. Note that results are restricted to the number of rows in the “Row limit” box. 
If you need to see more results, we recommend you use the same query in an EMR cluster or whatever other client application you use to query data through Okera.</p>

<h2 id="understanding-the-reports">Understanding the reports</h2>
<p>There are four reports displayed on the <code class="highlighter-rouge">Reports</code> page. They should mostly make sense without a lot of explanation, but each has a few details to note.</p>

<h3 id="number-of-queries-over-time">Number of queries over time</h3>
<p>This report shows the number of queries that occurred during the selected time range as a trend with each point representing the sum of queries in a particular time bucket. 
The total timerange is broken into buckets of a set size and the number of queries occurring during each bucket-sized span are summed to produce each point.
For day-long time ranges, the buckets are 10 minutes, for week-long time ranges, the buckets are an hour and 40 minutes.
Points’ timestamps represent the <em>end</em> of the bucket.
So, in a “Last 24 hours” report, if the value or a point is 120, that means 120 queries occurred in the 10 minutes prior to the time on the point.</p>

<p>“Number of queries over time” supports drilling down to see the actual list of queries in a particular bucket. 
To drill down, pick a bucket and click on it.
You will be redirected to the <code class="highlighter-rouge">Workspace</code> page where the query to look up the time bucket in question will already be populated. It will look similar to:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from okera_system.reporting_audit_logs
  where ymd&gt;='2018-08-06' and ymd&lt;='2018-08-13'
  and start_unix_time&gt;=1533585000000
  and start_unix_time&lt;=1534190400000
  and start_unix_time&gt;=1533936000000
  and start_unix_time&lt;=1533942000000
</code></pre></div></div>

<p>In addition to the details mentioned in the Drilldowns section above, this query has 4 unix timestamps.
The first two timestamps are part of the base query, restricting the data to the outer timerange of the timechart (“Last 24 hours”, “Last 7 days”, etc.), and the second timestamps restrict the range to the specific bucket that was clicked.
All of them intentionally restrict against <code class="highlighter-rouge">start_unix_time</code>, so we are counting when events started, not when they complete.</p>

<h3 id="number-of-queries-by-client-application">Number of queries by client application</h3>
<p>This report shows the most popular client applications ranked by number of queries run in the given time range.
The top ten client applications are represented as bars in a bar chart, and more applications will can be shown by clicking on the “All applications” button at the bottom of the panel.
Mouseover on the bars in the chart will show the number of queries on the application.
In the top ten bar chart, various versions of an application will be combined into one bar, but in the “All applications” modal, each version of an the application will be separated.</p>

<p>Clicking on any of the bars will drill down to the <code class="highlighter-rouge">Workspace</code> with a query similar to this one populated:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from okera_system.reporting_audit_logs
  where ymd&gt;='2018-08-12' and ymd&lt;='2018-08-13'
  and start_unix_time&gt;=1534113000000
  and start_unix_time&lt;=1534200000000
  and client_application like 'hive%'
</code></pre></div></div>
<p>As discussed in the Drilldowns section above, this query gets the audit logs in the current time range and filters by application name.
It uses <code class="highlighter-rouge">like</code> to pick up all versions of the application, which is stored as a string with the name first, then version.</p>

<h3 id="number-of-queries-by-dataset">Number of queries by dataset</h3>
<p>This report is very similar to “Number of queries by client application”, showing the most queried datasets in the selected time range. 
The top ten datasets are represented as bars in the bar chart, and the rest can be viewed by clicking “All datasets”.
You may notice some entries include multiple datasets separated by commas.
Those counts represent queries that included both of the datasets.
Mouseover on the bars in the chart will show the number of queries on that dataset.</p>

<p>Clicking on any of the bars will drill down to the <code class="highlighter-rouge">Workspace</code> with a query similar to this one populated:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from okera_system.reporting_audit_logs
  where ymd&gt;='2018-08-12' and ymd&lt;='2018-08-13'
  and start_unix_time&gt;=1534115400000
  and start_unix_time&lt;=1534202400000
  and (ae_table='okera_sample.users' or ae_view='okera_sample.users')
</code></pre></div></div>
<p>In addition to the details mentioned in the Drilldowns section above, this query restricts <code class="highlighter-rouge">ae_table</code> or <code class="highlighter-rouge">ae_view</code> to the specified dataset.</p>

<h3 id="top-users">Top users</h3>
<p>As the name implies, this report shows a list of users in the system, ranked by how many queries they ran in the given timeframe. 
Clicking on any row in the list will drill down to the <code class="highlighter-rouge">Workspace</code> with a query similar to this one populated:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from okera_system.reporting_audit_logs
  where ymd&gt;='2018-08-12' and ymd&lt;='2018-08-13'
  and start_unix_time&gt;=1534115400000
  and start_unix_time&lt;=1534202400000
  and user='sample_user'
</code></pre></div></div>
<p>Like the other drilldowns, this query restricts results based on time, then adds an additional constraint. 
In this case, exact user name.</p>


    <div class="tags">
        
    </div>




</div>



<footer>
            <div class="row">
                <div class="col-lg-12 footer">
                  <img src="assets/images/icon-footer.png" class="logo" />
                  <div class="footer-meta">
               &copy;2018 Okera, Inc. All rights reserved. <br />
 Site last generated: Aug 15, 2018
                  </div>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
