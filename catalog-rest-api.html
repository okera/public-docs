<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>REST API | Okera User Documentation</title>
<link rel="stylesheet" href="theme/css/syntax.css">
<link rel="icon" type="image/png" href="/assets/images/icon-favicon32.png">

<script src="https://use.fontawesome.com/d9343c4626.js"></script>

<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="theme/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css">
<link rel="stylesheet" href="theme/css/asciidoctor.css">
<link rel="stylesheet" href="theme/css/custom.css">
<link rel="stylesheet" href="theme/css/boxshadowproperties.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="theme/js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="theme/js/toc.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script>
<script src="theme/js/customscripts.js"></script>

<script>
$( document ).ready(function() {
  $( "blockquote:contains('Note')" ).addClass( "admonitionblock note" );
  $( "blockquote:contains('Warning')" ).addClass( "admonitionblock warning" );
  $( "blockquote:contains('Tip')" ).addClass( "admonitionblock tip" );
  $( ".admonitionblock.note" ).prepend( '<i class="fa fa-check admonition"></i>' );
  $( ".admonitionblock.warning" ).prepend( '<i class="fa fa-exclamation-triangle admonition"></i>' );
  $( ".admonitionblock.tip" ).prepend( '<i class="fa fa-lightbulb-o admonition"></i>' );
});
</script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>


</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="navbar-wordmark"><a href="/">
              <img src="assets/images/okera-wordmark-white.png" alt="Okera wordmark" /></a>
            </div>

        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <!-- <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li> -->
                <!-- entries without drop-downs appear here -->







                <li><a href="search">Search</a></li>



                <li><a href="https://www.okera.com/blog/" target="_blank">Okera Blog</a></li>



                <li><a href="https://okera.com" target="_blank">okera.com</a></li>



                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->


                <!-- comment out this block if you want to hide search
                <li class="dropdown">

                  <div id="search-demo-container">
                      <form action="/search" method="GET">
                      <input type="text" name="q" id="search-input" placeholder="Search the docs...">
                      </form>
                  </div>

                </li>
                end search -->
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">


            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">



<ul id="mysidebar" class="nav affix">
  <li class="sidebarTitle"> </li>



  <li>
      <a href="#">Discover</a>
      <ul>



          <li><a href="product-overview">Product Overview</a> </li>






          <li><a href="odas-overview">Okera Data Access Service Overview</a> </li>






          <li><a href="catalog-overview">Okera Catalog Overview</a> </li>






          <li><a href="okera-architecture-overview">Platform Architecture Overview</a> </li>




      </ul>
   </li>



  <li>
      <a href="#">Install</a>
      <ul>



          <li><a href="getting-started">Getting Started</a> </li>






          <li><a href="install">Installation Guide</a> </li>






          <li><a href="advanced-install">Advanced Installation Option</a> </li>






          <li><a href="kerberos-cluster-setup">Kerberos</a> </li>






          <li><a href="secure-okera-rest-api-ldap">LDAP Authentication</a> </li>






          <li><a href="secure-okera-rest-api-oauth">OAuth Authentication</a> </li>






          <li><a href="cluster-types">Cluster Types</a> </li>






          <li><a href="cluster-sizing">Cluster Sizing</a> </li>






          <li><a href="memory-usage">Platform Memory Usage</a> </li>






          <li><a href="secure-deployment-manager-rest-api">Deployment Manager REST Security</a> </li>




      </ul>
   </li>



  <li>
      <a href="#">Engage</a>
      <ul>



          <li><a href="web-ui-basics">Okera Portal Basics</a> </li>




      </ul>
   </li>



  <li>
      <a href="#">Administer</a>
      <ul>



          <li><a href="cluster-administration">Cluster Administration</a> </li>






          <li><a href="web-ui-admin">Okera Portal for Admins</a> </li>






          <li><a href="schema-design">Schema Design</a> </li>






          <li><a href="authorization">Authorization</a> </li>






          <li><a href="auditing">Auditing</a> </li>






          <li><a href="okera-database-cli">Database CLI</a> </li>






          <li><a href="ip-address-management">IP Address Management</a> </li>






          <li><a href="kubernetes-dashboard-quickstart">Cluster Monitoring with Kubernetes Addons</a> </li>






          <li><a href="cluster-launch-plugin-api">Cluster Launch API</a> </li>




      </ul>
   </li>



  <li>
      <a href="#">Integrate</a>
      <ul>



          <li><a href="emr-integration">EMR Integration</a> </li>






          <li><a href="pycerebro">Native Python Integration</a> </li>






          <li><a href="client-integration">Client Integration</a> </li>






          <li><a href="planner-integration">Planner Integration</a> </li>






          <li><a href="odas-cdh-integration">CDH Integration</a> </li>






          <li><a href="tableau-web-data-connector">Tableau Integration</a> </li>






          <li><a href="service-port-assignments">Service Ports</a> </li>




      </ul>
   </li>



  <li>
      <a href="#">Develop</a>
      <ul>



          <li><a href="supported-sql">Supported SQL</a> </li>






          <li><a href="odas-authentication">Authentication</a> </li>






          <li class="active"><a href="catalog-rest-api">REST API</a></li>






          <li><a href="client-configs">Client Configuration</a> </li>






          <li><a href="complex-types">Complex Data Types</a> </li>






          <li><a href="data-types">Supported Data Types</a> </li>






          <li><a href="extending-odas">Extending ODAS</a> </li>




      </ul>
   </li>



  <li>
      <a href="#">Reference</a>
      <ul>



          <li><a href="release-notes">Release Notes</a> </li>






          <li><a href="quick-recipes">Quick Recipes</a> </li>






          <li><a href="faq">Frequently Asked Questions</a> </li>




      </ul>
   </li>



      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->

    <li>

<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2', title: 'On This Page' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    </li>


</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>



        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">


<div class="post-content">








  <h1 id="rest-api">REST API</h1>

<p>This document describes the REST API of the Okera Catalog. This is intended for clients
that want to leverage all of the Okera functionality. In addition to this, clients can
connect using existing APIs, such as the Hive Metastore API.</p>

<p>The purpose of this API is to provide programmatic access to interact with the catalog.
For users that want to interactively access the catalog, it is recommended to use the
<code class="highlighter-rouge">odb</code>, which provides a more traditional CLI experience built on top of these APIs.</p>

<h2 id="authentication">Authentication</h2>

<p>Unless otherwise specified, the APIs require users to be authenticated. In general,
authentication can be done via Kerberos or by tokens. For token based authentication,
simply specify the token in the auth header: <code class="highlighter-rouge">authorization: Bearer &lt;TOKEN&gt;</code>.</p>

<p>See the <a href="odas-authentication">authentication document</a>
for details on how to get tokens and check if token authentication is working.</p>

<h2 id="ssl">SSL</h2>

<p>If ssl is enabled, all the calls should be made against https, instead of http. They are
otherwise unchanged.</p>

<h2 id="executing-hive-ddl">Executing Hive DDL</h2>

<p>Endpoint: <code class="highlighter-rouge">/api/hive-ddl</code> [POST]</p>

<p>This API allows you to execute HiveQL DDL statements. This can be used to create
datasets, create roles, issues grants, etc. The purpose of this API is to be compatible
with <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL">beeline</a>.</p>

<p>The POST request takes as a parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
    "query" [String]: Required, HiveQL DDL statement.
}
</code></pre></div></div>

<p>Example:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="nt">-X</span> POST <span class="nt">-d</span> <span class="s1">'{"query":"show databases"}'</span> localhost:5000/api/hive-ddl
</code></pre></div></div>

<p>As is the case with most SQL dialects, user names containing a dash need to be escaped.
This is accomplished by wrapping the username in backticks.</p>

<p>Example:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="nt">-X</span> POST <span class="nt">-d</span> <span class="s1">'{"query":"create role `user-one`"}'</span> localhost:5000/api/hive-ddl
</code></pre></div></div>

<h2 id="listing-databases">Listing Databases</h2>

<p>Endpoint: <code class="highlighter-rouge">/api/databases</code> [GET]<br />
Endpoint: <code class="highlighter-rouge">/api/databases</code> [POST]</p>

<p>The POST request takes as a parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "filter" [String]: Optional, filter on the name of databases to return. For example,
      'log*' returns all databases that start with 'log'.
}
</code></pre></div></div>

<h2 id="listing-datasets">Listing datasets</h2>

<p>Endpoint: <code class="highlighter-rouge">/api/datasets</code> [GET]<br />
Endpoint: <code class="highlighter-rouge">/api/datasets</code> [POST]</p>

<p>The POST request takes as a parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "db" [String]: Optional, database to retrieve datasets from. Default is 'default'.
  "filter" [String]: Optional, filter on the name of datasets to return. For example,
      'log*' returns all datasets that start with 'log'.
}
</code></pre></div></div>

<h2 id="details-of-a-dataset">Details of a Dataset</h2>

<p>Endpoint: <code class="highlighter-rouge">/api/datasets/{name}</code> [POST]</p>

<p>Returns: Dataset information as json. This includes the schema as well as other
information.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  'db' [String]: Database containing this dataset.
  'name' [String]: Name of dataset
  'schema' [List]: List of columns
}
</code></pre></div></div>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -X POST localhost:5000/api/datasets/okera_sample.sample
</code></pre></div></div>

<h2 id="scanning-a-dataset">Scanning a Dataset</h2>

<p>Endpoint: <code class="highlighter-rouge">/api/scan/{name}</code> [GET] <br />
Endpoint: <code class="highlighter-rouge">/api/scanpage/{name}</code> [GET] <br />
Endpoint: <code class="highlighter-rouge">/api/scan</code> [POST] <br />
Endpoint: <code class="highlighter-rouge">/api/scanpage</code> [POST]</p>

<p>Returns dataset as json. The scan API will only return the initial rows. Scanpage returns
a handle that can be used to retrieve all the records.</p>

<p>Example:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl localhost:5000/api/scan/okera_sample.sample
</code></pre></div></div>

<p>The POST request takes as a parameter:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "query" [String]:   "SQL Query to execute"
}
</code></pre></div></div>

<p>Example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -X POST -H 'Content-Type: application/json' \
-d '{"query" : "select uid, ccn from okera.sample.users"}' localhost:5000/api/scan
</code></pre></div></div>

<p>The <code class="highlighter-rouge">scanpage</code> API accepts two optional argument <code class="highlighter-rouge">records=</code>, which is the total number
of records to return for the query, and <code class="highlighter-rouge">session_id</code>. The API returns records in batches
of up to 10,000.</p>

<p>The <code class="highlighter-rouge">session_id</code> value is used on subsequent queries to return successive batches of
records. It must be omitted on the first query.</p>

<p>NOTE: session ids are only valid for 30-seconds, starting from the time that the ODAS
cluster starts returning data. That timer is reset each time a query is received for
a given session_id.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl &lt;odas_rest_server_endpoint&gt;/api/scanpage/products?user<span class="o">=</span>presto
<span class="nv">$ </span>curl &lt;odas_rest_server_endpoint&gt;/api/scanpage/products?user<span class="o">=</span>presto&amp;records<span class="o">=</span>25000
<span class="nv">$ </span>curl &lt;odas_rest_server_endpoint&gt;/api/scanpage/products?user<span class="o">=</span>presto&amp;session_id<span class="o">=</span>77480ad07d743bb1:b4f7822f036c6c91
</code></pre></div></div>

<p>Each returned object contains:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  'records' [List]: Each entry is an object containing the field names, types and values of each record.
  'session_id' [String]: Key used to return subsequent 'pages'.  Each page contains up to 10,000 entries.  When the final page is returned, 'session_id' is "-1".
}
</code></pre></div></div>


    <div class="tags">

    </div>




</div>



<footer>
            <div class="row">
                <div class="col-lg-12 footer">
                  <img src="assets/images/icon-footer.png" class="logo" />
                  <div class="footer-meta">
               &copy;2018 Okera, Inc. All rights reserved. <br />
 Site last generated: May 18, 2018
                  </div>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
