<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Role-based Access Control | Okera User Documentation</title>
<link rel="stylesheet" href="theme/css/syntax.css">
<link rel="icon" type="image/png" href="/assets/images/icon-favicon32.png">

<script src="https://use.fontawesome.com/d9343c4626.js"></script>

<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="theme/css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
  crossorigin="anonymous">
<!-- Old Algolia Instant Search -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css"> -->
<!-- End Old Algolia Instant Search -->
<link rel="stylesheet" href="theme/css/asciidoctor.css">
<link rel="stylesheet" href="theme/css/custom.css">
<link rel="stylesheet" href="theme/css/boxshadowproperties.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="theme/js/jquery.navgoco.min.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
  crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="theme/js/toc.js"></script>
<script src="theme/js/customscripts.js"></script>

<!-- Old Algolia Instant Search -->
<!-- <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script> -->
<!-- End Old Algolia Instant Search -->

<!-- Include AlgoliaSearch JS Client and autocomplete.js library -->
<script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>

<script>
  $(document).ready(function () {
    $("blockquote:contains('Note')").addClass("admonitionblock note");
    $("blockquote:contains('Warning')").addClass("admonitionblock warning");
    $("blockquote:contains('Tip')").addClass("admonitionblock tip");
    $(".admonitionblock.note").prepend('<i class="fa fa-check admonition"></i>');
    $(".admonitionblock.warning").prepend('<i class="fa fa-exclamation-triangle admonition"></i>');
    $(".admonitionblock.tip").prepend('<i class="fa fa-lightbulb-o admonition"></i>');
  });
</script>


<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">

        <div class="row">
            <div class="col-sm-4 col-md-3">

                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <div class="navbar-wordmark">
                        <a href="/">
                            <img src="assets/images/okera-wordmark-white.svg" alt="Okera wordmark" />
                        </a>
                    </div>
                </div>

                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

                    <ul class="nav navbar-nav">
                        <!-- toggle sidebar button -->
                        <!-- <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li> -->
                        <!-- entries without drop-downs appear here -->

                            
                        <li>
                            <a href="https://okera.com" target="_blank">okera.com</a>
                        </li>
                          
                        <!-- entries with drop-downs appear here -->
                        <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                         
                    </ul>
                </div>
            </div>
            <form class="aa-input-container navbar-form" id="aa-input-container" role="search">
                <div class="form-group">
                    <input id="aa-search-input" type="text" class="aa-input-search form-control" placeholder="Search"
                        autocomplete="off">
                </div>
            </form>
        </div>
        <!-- Algolia Integrated search Script -->
        <script type="text/javascript" src="theme/js/okera-integrated-search.js"></script>
        <!-- comment out this block if you want to hide jekyll search
                  <div class="navbar-form" id="search-demo-container">
                      <form action="/search" method="GET">
                      <input type="text" name="q" id="search-input" placeholder="Search the docs...">
                      </form>
                  </div>
                end search -->
    </div>
</nav>
<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                


<ul id="mysidebar" class="nav affix">
  <li class="sidebarTitle"> </li>
  
  
  
  <li>
      <a href="#">Introduction to Okera</a>
      <ul>
          
          
          
          <li><a href="product-overview">Product Overview</a> </li>
          
          
          
          
          
          
          <li><a href="odas-overview">Okera Data Access Service Overview</a> </li>
          
          
          
          
          
          
          <li><a href="catalog-overview">Okera Catalog Overview</a> </li>
          
          
          
          
          
          
          <li><a href="okera-architecture-overview">Platform Architecture Overview</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Installing Okera</a>
      <ul>
          
          
          
          <li><a href="getting-started">Getting Started</a> </li>
          
          
          
          
          
          
          <li><a href="install">Installation Overview</a> </li>
          
          
          
          
          
          
          <li><a href="install-prereqs">Installation Prerequisites</a> </li>
          
          
          
          
          
          
          <li><a href="install-dm">Setting up the Deployment Manager</a> </li>
          
          
          
          
          
          
          <li><a href="install-odas">Setting up the ODAS Cluster</a> </li>
          
          
          
          
          
          
          <li><a href="advanced-install">Advanced Installation Options</a> </li>
          
          
          
          
          
          
          <li><a href="awsguide">AWS Guide</a> </li>
          
          
          
          
          
          
          <li><a href="odas-authentication">Authentication Guide</a> </li>
          
          
          
          
          
          
          <li><a href="kerberos-cluster-setup">Kerberos</a> </li>
          
          
          
          
          
          
          <li><a href="secure-okera-rest-api-ldap">LDAP Authentication</a> </li>
          
          
          
          
          
          
          <li><a href="secure-okera-rest-api-oauth">OAuth Authentication</a> </li>
          
          
          
          
          
          
          <li><a href="secure-deployment-manager-rest-api">Deployment Manager REST Security</a> </li>
          
          
          
          
          
          
          <li><a href="support-versions">Versions</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Administering ODAS Clusters</a>
      <ul>
          
          
          
          <li><a href="cluster-administration">Cluster Administration</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-types">Cluster Types</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-sizing">Cluster Sizing</a> </li>
          
          
          
          
          
          
          <li><a href="memory-usage">Platform Memory Usage</a> </li>
          
          
          
          
          
          
          <li><a href="ip-address-management">IP Address Management</a> </li>
          
          
          
          
          
          
          <li><a href="kubernetes-dashboard-quickstart">Cluster Monitoring with Kubernetes Addons</a> </li>
          
          
          
          
          
          
          <li><a href="cluster-launch-plugin-api">Cluster Launch API</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Using the Catalog</a>
      <ul>
          
          
          
          <li class="active"><a href="authorization">Role-based Access Control</a></li>
          
          
          
          
          
          
          <li><a href="privileges">Privileges</a> </li>
          
          
          
          
          
          
          <li><a href="schema-design">Schema Design</a> </li>
          
          
          
          
          
          
          <li><a href="authorization-builtins">Authorization Builtin Functions</a> </li>
          
          
          
          
          
          
          <li><a href="auditing">Auditing</a> </li>
          
          
          
          
          
          
          <li><a href="okera-database-cli">Database CLI</a> </li>
          
          
          
          
          
          
          <li><a href="supported-sql">Supported SQL</a> </li>
          
          
          
          
          
          
          <li><a href="jdbc-data-source">JDBC Data Source</a> </li>
          
          
          
          
          
          
          <li><a href="data-types">Supported Data Types</a> </li>
          
          
          
          
          
          
          <li><a href="complex-types">Complex Data Types</a> </li>
          
          
          
          
          
          
          <li><a href="extending-odas">Extending ODAS</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Using the Web UI</a>
      <ul>
          
          
          
          <li><a href="web-ui-basics">Okera Portal Basics</a> </li>
          
          
          
          
          
          
          <li><a href="datasets-page">Datasets Page</a> </li>
          
          
          
          
          
          
          <li><a href="permissions-page">Permissions Page</a> </li>
          
          
          
          
          
          
          <li><a href="reports-page">Reports Page</a> </li>
          
          
          
          
          
          
          <li><a href="web-ui-admin">Okera Portal for Admins</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Integrating with ODAS</a>
      <ul>
          
          
          
          <li><a href="catalog-rest-api">REST API</a> </li>
          
          
          
          
          
          
          <li><a href="client-configs">Client Configuration</a> </li>
          
          
          
          
          
          
          <li><a href="hive-best-practices">Hive Integration - Best Practices</a> </li>
          
          
          
          
          
          
          <li><a href="emr-integration">EMR Integration</a> </li>
          
          
          
          
          
          
          <li><a href="pyokera">Native Python Integration</a> </li>
          
          
          
          
          
          
          <li><a href="client-integration">Client Integration</a> </li>
          
          
          
          
          
          
          <li><a href="planner-integration">Planner Integration</a> </li>
          
          
          
          
          
          
          <li><a href="third-party-integration">Third-Party Integration</a> </li>
          
          
          
          
          
          
          <li><a href="odas-cdh-integration">CDH Integration</a> </li>
          
          
          
          
          
          
          <li><a href="tableau-web-data-connector">Tableau Integration</a> </li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Reference</a>
      <ul>
          
          
          
          <li><a href="release-notes">Release Notes</a> </li>
          
          
          
          
          
          
          <li><a href="earlier-release-notes">Earlier Release Notes</a> </li>
          
          
          
          
          
          
          <li><a href="service-port-assignments">Service Ports</a> </li>
          
          
          
          
          
          
          <li><a href="s3-encryption-support">Supported S3 Encryption Types</a> </li>
          
          
          
          
          
          
          <li><a href="compatibility-guarantees">Compatibility Guarantees</a> </li>
          
          
          
          
          
          
          <li><a href="quick-recipes">Quick Recipes</a> </li>
          
          
          
          
          
          
          <li><a href="https://okera.zendesk.com/hc/en-us/categories/115000493607-FAQs" target="_blank">Frequently Asked Questions</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
        -->
    
    <li>
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2', title: 'On This Page' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 80);
  return false
})

});
</script>

<div id="toc"></div>

    </li>
    

</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            

<div class="post-content">

   

    


    

  <h1 id="role-based-access-control">Role-based Access Control</h1>

<p><em>This document is for DBAs, developers, and data architects, who are looking for information about how role-based access control works, as related to the Okera Policy Engine.</em></p>

<h2 id="introduction">Introduction</h2>

<p>As introduced in the <a href="catalog-overview">Catalog Overview</a> documentation, the Okera Catalog services include the Okera Policy Engine, which is used throughout the platform to power the self-service authorization process.
The Okera Platform is in many ways similar to an RDBMS, as it exposes data primarily through a table structure, no matter what the underlying storage technology provides.
Okera also exposes RDBMS-like functionality when it comes to authorizing access to data.</p>

<p>By default, no data is accessible when standing up an Okera Active Data Access Platform and pointing users to it.
Instead, the initial administrators of the platform (which must be configured at the cluster level) can grant access to objects in a variety of ways.
The administrator can also delegate administrative rights of an object and its child objects to regular users or groups of users.
For example, an initial admin could grant full access and administrative rights for the database <code class="highlighter-rouge">"sales"</code> to the <code class="highlighter-rouge">"salesadmin"</code> user group.
The Policy Engine supports this by providing a very flexible approach, called <em>role-based access control</em> (RBAC).</p>

<h2 id="access-control">Access Control</h2>

<p>Instead of linking users or groups of users directly to resources, such as database or datasets, the Policy Engine decouples the former from the latter using <em>roles</em>.
These are arbitrarily named collections of permissions that pertained objects in the Schema Registry.
For instance, you could create a role <code class="highlighter-rouge">"admins"</code> that has full access to the entire catalog, which subsumes all objects contained.
Or you could create a role for just a particular purpose inside the sales department, such as being able to read and write all tables necessary for customer relationship management (CRM).
The following diagram shows how users are commonly grouped together and then assigned roles from the Policy Engine.</p>

<p><a name="Role-based Access Control"></a>
<img src="assets/images/authz-rbac.png" style="width: 100%; max-width:100%;" /></p>

<p>The advantage of decoupling roles from the user groups is that the roles can be combined to assign all the required permissions to the users of a particular group.
You can define a role that can read a subset of a particular table, and another that allows to write into another table subset.
Assigning both these roles to a group of users will enable that group to do both operations.
Then you assign a user to such a group and give immediate access to the combined functionality.</p>

<blockquote>
  <p><strong>Note:</strong> It is common for Linux/Unix based operating systems (OS) to assign a user a dedicated group that has the same name as the user.
You can use that specific group to assign particular roles at a user level.
In practice though it is more common to create broader groups with more than one user to assign permissions in bulk.</p>
</blockquote>

<h2 id="managing-roles">Managing Roles</h2>

<p>The syntax for creating (or removing) a role is straight forward:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">ROLE</span> <span class="o">&lt;</span><span class="n">role_name</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">DROP</span> <span class="k">ROLE</span> <span class="o">&lt;</span><span class="n">role_name</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p>Using this command is equally simple:</p>

<p><strong>Example:</strong> Creating a role</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">sales_analysts</span><span class="p">;</span>
</code></pre></div></div>

<blockquote>
  <p><strong>Note:</strong> When you drop a role, all of its assigned permissions are removed as well (as expected).</p>
</blockquote>

<h2 id="privileges-and-scope">Privileges and Scope</h2>
<p>For role-based access control, each role can be assigned a permission, called a privilege, to a specific object, at the scope of the object type.
See <a href="privileges">Privileges</a> for an explanation of all the privileges and scopes supported by The Okera Policy Engine.</p>

<h2 id="managing-data-access">Managing Data Access</h2>

<p>The combination of role, privilege, and object is referred to as <em>granting</em> in SQL.
Okera supports the following SQL statements to give or remove access to roles:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span>
    <span class="o">&lt;</span><span class="n">privilege_level</span><span class="o">&gt;</span> <span class="p">[(</span><span class="o">&lt;</span><span class="n">column_list</span><span class="o">&gt;</span><span class="p">)]</span>
    <span class="k">ON</span> <span class="o">&lt;</span><span class="n">object_type_name</span><span class="o">&gt;</span>
    <span class="k">TO</span> <span class="p">[</span><span class="k">ROLE</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">role_name</span><span class="o">&gt;</span>
    <span class="p">[</span><span class="k">WITH</span> <span class="k">GRANT</span> <span class="k">OPTION</span><span class="p">]</span>

<span class="k">REVOKE</span>
    <span class="p">[</span><span class="k">GRANT</span> <span class="k">OPTION</span> <span class="k">FOR</span><span class="p">]</span>
    <span class="o">&lt;</span><span class="n">privilege_level</span><span class="o">&gt;</span>
    <span class="k">ON</span> <span class="o">&lt;</span><span class="n">object_type_name</span><span class="o">&gt;</span>
    <span class="k">FROM</span> <span class="p">[</span><span class="k">ROLE</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">role_name</span><span class="o">&gt;</span>

<span class="k">SHOW</span>
   <span class="n">ROLES</span> <span class="p">[</span><span class="k">LIKE</span> <span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">]</span>

<span class="o">&lt;</span><span class="n">privilege_level</span><span class="o">&gt;</span><span class="p">:</span> <span class="err">{</span>
    <span class="k">ALL</span>
  <span class="o">|</span> <span class="k">SELECT</span>
  <span class="o">|</span> <span class="k">CREATE</span>
  <span class="o">|</span> <span class="k">ALTER</span>
  <span class="o">|</span> <span class="k">INSERT</span>
  <span class="o">|</span> <span class="k">SHOW</span>
<span class="err">}</span>

<span class="o">&lt;</span><span class="n">object_type_name</span><span class="o">&gt;</span><span class="p">:</span> <span class="err">{</span>
    <span class="k">CATALOG</span>
  <span class="o">|</span> <span class="k">DATABASE</span> <span class="o">&lt;</span><span class="n">database_name</span><span class="o">&gt;</span>
  <span class="o">|</span> <span class="k">TABLE</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span>
  <span class="o">|</span> <span class="n">URI</span> <span class="o">&lt;</span><span class="n">uri</span><span class="o">&gt;</span>
<span class="err">}</span>
</code></pre></div></div>

<p>Further, the following commands can be used to add to and remove roles from user groups:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span>
    <span class="k">ROLE</span> <span class="o">&lt;</span><span class="n">role_name</span><span class="o">&gt;</span>
    <span class="k">TO</span> <span class="k">GROUP</span> <span class="o">&lt;</span><span class="n">group_name</span><span class="o">&gt;</span>

<span class="k">REVOKE</span>
    <span class="k">ROLE</span> <span class="o">&lt;</span><span class="n">role_name</span><span class="o">&gt;</span>
    <span class="k">FROM</span> <span class="k">GROUP</span> <span class="o">&lt;</span><span class="n">group_name</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>The following short examples show how these statements are used:</p>

<p><strong>Example: Granting full read access for a table to a role</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="k">TABLE</span> <span class="n">sales</span><span class="p">.</span><span class="n">transactions</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_analysts</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>Example: Granting read access for specific columns of a table to a role</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">SELECT</span> <span class="p">(</span><span class="n">txnid</span><span class="p">,</span> <span class="n">sku</span><span class="p">,</span> <span class="n">price</span><span class="p">)</span> <span class="k">ON</span> <span class="k">TABLE</span> <span class="n">sales</span><span class="p">.</span><span class="n">transactions</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_analysts</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>Example:</strong> Granting show access on a database to a role</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">SHOW</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">sales</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_analysts</span><span class="p">;</span>
</code></pre></div></div>

<p>Combining a role with a group of users is shown in the next set of examples:</p>

<p><strong>Example: Granting a role to a user group</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">ROLE</span> <span class="n">sales_analysts</span> <span class="k">TO</span> <span class="k">GROUP</span> <span class="n">test</span>
</code></pre></div></div>

<p><strong>Example: Granting a role to a specific user</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">ROLE</span> <span class="n">admin_role</span> <span class="k">TO</span> <span class="k">GROUP</span> <span class="n">janedoe</span>
</code></pre></div></div>

<p><strong>Example:</strong> show roles matching pattern</p>

<p>pattern is case insensitive. This includes
star(*) as wild card to match any number of characters
bar(|) for alternates. Either pattern matches</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SHOW</span> <span class="n">ROLES</span> <span class="k">LIKE</span> <span class="s1">'*sales*'</span>
<span class="k">SHOW</span> <span class="n">ROLES</span> <span class="k">LIKE</span> <span class="s1">'sales*|marketing*'</span>
</code></pre></div></div>

<h2 id="best-practices">Best Practices</h2>

<p>Using roles, privileges, and permissions properly takes practice.
The following sections discuss the best-practices as recommended by Okera, based on working with enterprise customers.</p>

<h3 id="role-mapping">Role Mapping</h3>

<p>Roles can be used complementary, that is, they can be combined to form an <em>effective</em> user access profile.
Dependent on the business role a user is assigned to, it makes sense to define specific roles that are then assigned to the appropriate user groups.</p>

<h4 id="global-administrators">Global Administrators</h4>

<p>There are two ways of defining global administrators, which are those user that have unrestricted access to the entire ODAS cluster and its associated Catalog.</p>

<ol>
  <li>
    <p>By Configuration</p>

    <p>You can define a list of user groups that are given global administrative rights as part of the Deployment Manager configuration:</p>

    <p><strong>Example:</strong> Defining specific user groups as global catalog administrators</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">OKERA_CATALOG_ADMINS</span><span class="o">=</span><span class="s2">"sysadmins,devadmins,dataadmins"</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>By Role</p>

    <p>The other option is to define a role that grants all permissions to at the catalog level:</p>

    <p><strong>Example:</strong> Granting global administrative rights to a role</p>

    <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">ON</span> <span class="k">CATALOG</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">global_admin_role</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ROLE</span> <span class="n">global_admin_role</span> <span class="k">TO</span> <span class="k">GROUP</span> <span class="n">admins</span><span class="p">;</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>Either way, through configuration or role, any user in such a group is considered a global administrator.
The difference is that the latter can be modified without having to restart the ODAS cluster providing the Catalog services.</p>

<h4 id="data-stewards">Data Stewards</h4>

<p>With the advent of big data there has been an increase in the number of datasets an organization has to manage.
The business role of <em>data steward</em> has been gaining importance in this context, as its tasks include the classification of datasets for use by regular data consumers, such as analysts or data scientists.
In a way the data steward is an administrative role that needs to have access to all datasets, and being able to grant access to those datasets with varying levels of permissions.</p>

<p>Since data stewards are not system administrators, their scope can be limited as needed.
For example, there could be multiple data steward roles for different parts of the business.
The general approach is shown in the following example:</p>

<p><strong>Example:</strong> Defining a global data steward role</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">data_stewards</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="k">CATALOG</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">data_stewards</span> <span class="k">WITH</span> <span class="k">GRANT</span> <span class="k">OPTION</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>Example:</strong> grant all on a database to steward role</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">marketing</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">data_stewards</span> <span class="k">WITH</span> <span class="k">GRANT</span> <span class="k">OPTION</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="compartmentalized-data-access">Compartmentalized Data Access</h4>

<p>It is common in practice to group databases and datasets together based on a specific business requirement.
An example here is to group catalog objects by departments, such as <em>sales</em>, <em>marketing</em>, or <em>administration</em>.
Within each group of objects it is recommended to split up responsibilities in group administrators and regular users.
An analyst may also create datasets, often views over existing tables. So, (s)he may be given the create privilege.
A producer role may be used for creating or altering table. An example would be an ETL user.
This is achieved by defining two roles for each object grouping, while giving each the appropriate privileges:</p>

<p><strong>Example:</strong> Defining admin and user roles for an object group</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">sales_admins</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">sales_analysts</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">ROLE</span> <span class="n">sales_producer</span><span class="p">;</span>

<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">sales</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_admins</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">ON</span> <span class="n">URI</span> <span class="s1">'s3://acme-data/department/sales'</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_admins</span><span class="p">;</span>

<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">sales</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_analysts</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">CREATE</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">sales</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_analysts</span><span class="p">;</span>

<span class="k">GRANT</span> <span class="k">CREATE</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">sales</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_producer</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">INSERT</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">sales</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_producer</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALTER</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">sales</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="n">sales_producer</span><span class="p">;</span>
</code></pre></div></div>

<p>The example creates a role for all admins of the <em>sales</em> department, and another role for all analysts that need to access the data.
Note that since the sales administrator role has no global rights, it is necessary to grant it access to the URI pointing to where its data is located.</p>

<h4 id="public-data">Public Data</h4>

<p>Another use-case for roles is to define a shared role that is opening access to all public datasets.</p>

<p><strong>Example:</strong> Defining a global role for access to all public datasets</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">ROLE</span> <span class="k">public</span><span class="p">;</span>

<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="k">DATABASE</span> <span class="n">publicdata</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="k">public</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">SELECT</span> <span class="k">ON</span> <span class="k">TABLE</span> <span class="n">sales</span><span class="p">.</span><span class="n">transactions</span> <span class="k">TO</span> <span class="k">ROLE</span> <span class="k">public</span><span class="p">;</span>
<span class="p">...</span>
</code></pre></div></div>

<p>The example creates the role and grants access to as many public datasets as required.
Granting this role to any user group will immediately open access to all public datasets for reading.
And since all public datasets are covered by one role, it is easy to add or remove a dataset and instantly have this reflected for all users.</p>

<h3 id="developing-functions">Developing Functions</h3>

<p>As explained in <a href="privileges#uri-objects">URI Objects</a>, only administrators are allowed to register user-defined functions (UDFs).
This is deliberately the case to protect the ODAS services from faulty, erroneous, or even malicious code being executed in the server processes.
It is normal in practice for ODAS service to run for many days, weeks, or months before a scheduled maintenance is taking place.
How can a developer design, implement, test, and deploy a new function or SerDe (see <a href="extending-odas">Extending ODAS</a>) without disruption of production services?</p>

<p>Okera recommends a multi-step process that can solve this problem:</p>

<ol>
  <li>
    <p><strong>Develop UDF using Hive</strong></p>

    <p>Using Hive with the <code class="highlighter-rouge">ADD JAR</code> statement allows adding a resource under development in Hive only.
The JAR will not be loaded into (or even be made aware to) the ODAS processes, and creating a view making use of it would execute in the context of Hive only.
In this case ODAS will provide the lower-level tables only.</p>

    <blockquote>
      <p><strong>Note:</strong> For users who use Hive provided by EMR that is integrated with ODAS, Okera recommends the use of <a href="emr-integration#cluster-local-databases">cluster local databases</a> to circumvent any interference with ODAS.
An alternative is the use of <a href="supported-sql#internal-versus-external-views">external views</a>, which are evaluated only in the context of Hive, which includes the UDF that is in development.</p>
    </blockquote>
  </li>
  <li>
    <p><strong>Add to ODAS for long-term use</strong></p>

    <p>Once the UDF is considered done, it can be moved into ODAS by uploading the resources (that is, the JAR file containing the code) to a release directory that is accessible by the ODAS processes (commonly a shared file system such as S3 in case of AWS setups) and declaring the function as usual.</p>
  </li>
</ol>

<h3 id="local-databases">Local Databases</h3>

<p>Extending on the example of UDFs above, Okera recommends the use of <a href="emr-integration#cluster-local-databases">cluster local databases</a> for all temporary schema tasks.
Okera recommends to define a proper, company-wide naming scheme for local databases, as they share the same namespace as other databases.
Should a user have a local and managed database with the same name, the local one takes preference.
This is intentionally allowing a developer to experiment with existing databases by temporarily overlaying them with something different.
Otherwise it is advised to use specific names for local database, for example, by prefixing the name with <code class="highlighter-rouge">"localdb_"</code>.</p>

<h3 id="public-role">Public Role</h3>

<p>Starting in ODAS 1.2.0, users automatically have the <code class="highlighter-rouge">okera_public_role</code> role regardless of the user’s groups.
The only special property of this role is that all users have it, without needing to be granted the role.
Otherwise, the role behaves like any other and catalog admins can grant and revoke privileges to and from this role.
By default, this role has SELECT access to the database <code class="highlighter-rouge">okera_sample</code> which includes some sample data and diganostic views.</p>

<p>We expect this role to be used to grant access to the public portion of the catalog.</p>


    <div class="tags">
        
    </div>




</div>



<footer>
  <div class="row">
    <div class="col-lg-12 footer">
      <div class="footer-meta">
        &copy;2019 Okera, Inc. All rights reserved.  Site last generated: Mar 26, 2019
      </div>
    </div>
  </div>
</footer>

        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
